{"ast":null,"code":"export function insertToDatabase(db, table, data) {\n  var transaction = db.transaction([table], \"readwrite\");\n\n  transaction.oncomplete = function (event) {\n    console.log(\"All done!\");\n  };\n\n  transaction.onerror = function (event) {\n    // Generic error handler for all errors targeted at this database's request\n    console.error(\"Database error: \" + event.target.errorCode);\n  };\n\n  var objectStore = transaction.objectStore(table);\n  var request = objectStore.add(data);\n\n  request.onsuccess = function (event) {};\n}\nexport function databaseGetAll(db) {\n  var transaction = db.transaction('log', 'readonly');\n  var objectStore = transaction.objectStore('log');\n\n  objectStore.getAll().onsuccess = function (event) {\n    return event.target.result;\n  };\n}\nexport function playSound(sound) {\n  var msg = new SpeechSynthesisUtterance(sound);\n  window.speechSynthesis.speak(msg);\n}\nexport function formatEpoch(seconds) {\n  var date = new Date(0);\n  date.setSeconds(seconds);\n  return date.toISOString().substr(11, 8);\n}\nvar mediaRecorder = {};\nvar chunks = [];\nexport function recordAudio() {\n  // Ensure getUserMedia is supported\n  if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n    console.log('getUserMedia supported.');\n    navigator.mediaDevices.getUserMedia({\n      audio: true\n    }) // Success callback, start recording\n    .then(stream => this.startRecording(stream)) // Error callback\n    .catch(function (err) {\n      console.log('The following getUserMedia error occured: ' + err);\n    });\n  } else {\n    console.log('getUserMedia not supported on your browser!');\n  }\n}\nexport function startRecording() {\n  // Start recording\n  mediaRecorder = new MediaRecorder(stream);\n  mediaRecorder.start(10); // Start visualizing audio\n  // visualize(stream);\n\n  console.log(\"recorder started\");\n\n  mediaRecorder.ondataavailable = function (e) {\n    chunks.push(e.data);\n  };\n}\nexport function stopAudioRecording() {\n  // Stop recording\n  mediaRecorder.stop();\n  console.log(mediaRecorder.state);\n  console.log(\"recorder stopped\");\n\n  mediaRecorder.onstop = e => stopRecording(e);\n}\n\nstopRecording = e => {\n  // Stop and save the recording\n  console.log(\"recorder onstopped\");\n  const soundClips = document.querySelector('.sound-clips');\n  const clipName = prompt('Enter a name for your sound clip');\n  const clipContainer = document.createElement('article');\n  const clipLabel = document.createElement('p');\n  const audio = document.createElement('audio');\n  const deleteButton = document.createElement('button');\n  clipContainer.classList.add('clip');\n  audio.setAttribute('controls', '');\n  deleteButton.innerHTML = \"Delete\";\n  clipLabel.innerHTML = clipName;\n  clipContainer.appendChild(audio);\n  clipContainer.appendChild(clipLabel);\n  clipContainer.appendChild(deleteButton);\n  soundClips.appendChild(clipContainer);\n  audio.controls = true;\n  const blob = new Blob(chunks, {\n    'type': 'audio/ogg; codecs=opus'\n  });\n  chunks = [];\n  const audioURL = window.URL.createObjectURL(blob);\n  audio.src = audioURL;\n\n  deleteButton.onclick = function (e) {\n    let evtTgt = e.target;\n    evtTgt.parentNode.parentNode.removeChild(evtTgt.parentNode);\n  };\n};\n\nvisualize = stream => {\n  // Visualize audio stream\n  const canvas = document.querySelector('.visualizer');\n  const canvasCtx = canvas.getContext(\"2d\");\n  let audioCtx;\n\n  if (!audioCtx) {\n    audioCtx = new AudioContext();\n  }\n\n  const source = audioCtx.createMediaStreamSource(stream);\n  const analyser = audioCtx.createAnalyser();\n  analyser.fftSize = 2048;\n  const bufferLength = analyser.frequencyBinCount;\n  const dataArray = new Uint8Array(bufferLength);\n  source.connect(analyser); //analyser.connect(audioCtx.destination);\n\n  draw();\n\n  function draw() {\n    const WIDTH = canvas.width;\n    const HEIGHT = canvas.height;\n    requestAnimationFrame(draw);\n    analyser.getByteTimeDomainData(dataArray);\n    canvasCtx.fillStyle = 'rgb(200, 200, 200)';\n    canvasCtx.fillRect(0, 0, WIDTH, HEIGHT);\n    canvasCtx.lineWidth = 2;\n    canvasCtx.strokeStyle = 'rgb(0, 0, 0)';\n    canvasCtx.beginPath();\n    let sliceWidth = WIDTH * 1.0 / bufferLength;\n    let x = 0;\n\n    for (let i = 0; i < bufferLength; i++) {\n      let v = dataArray[i] / 128.0;\n      let y = v * HEIGHT / 2;\n\n      if (i === 0) {\n        canvasCtx.moveTo(x, y);\n      } else {\n        canvasCtx.lineTo(x, y);\n      }\n\n      x += sliceWidth;\n    }\n\n    canvasCtx.lineTo(canvas.width, canvas.height / 2);\n    canvasCtx.stroke();\n  }\n};","map":{"version":3,"sources":["/Users/vascoxu/Desktop/smash/mohs/frontend/src/Components/helpers.js"],"names":["insertToDatabase","db","table","data","transaction","oncomplete","event","console","log","onerror","error","target","errorCode","objectStore","request","add","onsuccess","databaseGetAll","getAll","result","playSound","sound","msg","SpeechSynthesisUtterance","window","speechSynthesis","speak","formatEpoch","seconds","date","Date","setSeconds","toISOString","substr","mediaRecorder","chunks","recordAudio","navigator","mediaDevices","getUserMedia","audio","then","stream","startRecording","catch","err","MediaRecorder","start","ondataavailable","e","push","stopAudioRecording","stop","state","onstop","stopRecording","soundClips","document","querySelector","clipName","prompt","clipContainer","createElement","clipLabel","deleteButton","classList","setAttribute","innerHTML","appendChild","controls","blob","Blob","audioURL","URL","createObjectURL","src","onclick","evtTgt","parentNode","removeChild","visualize","canvas","canvasCtx","getContext","audioCtx","AudioContext","source","createMediaStreamSource","analyser","createAnalyser","fftSize","bufferLength","frequencyBinCount","dataArray","Uint8Array","connect","draw","WIDTH","width","HEIGHT","height","requestAnimationFrame","getByteTimeDomainData","fillStyle","fillRect","lineWidth","strokeStyle","beginPath","sliceWidth","x","i","v","y","moveTo","lineTo","stroke"],"mappings":"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","sourcesContent":["export function insertToDatabase(db, table, data) {\n  var transaction = db.transaction([table], \"readwrite\");\n\n  transaction.oncomplete = function(event) {\n    console.log(\"All done!\");\n  };\n\n  transaction.onerror = function(event) {\n    // Generic error handler for all errors targeted at this database's request\n    console.error(\"Database error: \" + event.target.errorCode);    \n  };\n\n  var objectStore = transaction.objectStore(table);\n  var request = objectStore.add(data);\n  request.onsuccess = function(event) {\n  }\n}\n\nexport function databaseGetAll(db) {\n  var transaction = db.transaction('log', 'readonly');\n  var objectStore = transaction.objectStore('log');\n  objectStore.getAll().onsuccess = function(event) {\n    return event.target.result\n  };\n}\n\nexport function playSound(sound) {\n  var msg = new SpeechSynthesisUtterance(sound);\n  window.speechSynthesis.speak(msg);\n}\n\nexport function formatEpoch(seconds) {\n  var date = new Date(0);\n  date.setSeconds(seconds);\n  return date.toISOString().substr(11, 8);\n}\n\nvar mediaRecorder = {};\nvar chunks = [];\nexport function recordAudio() {\n  // Ensure getUserMedia is supported\n  if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n    console.log('getUserMedia supported.');\n    navigator.mediaDevices.getUserMedia (\n      {\n        audio: true\n      })\n\n      // Success callback, start recording\n      .then((stream) => this.startRecording(stream))\n\n      // Error callback\n      .catch(function(err) {\n        console.log('The following getUserMedia error occured: ' + err);\n      }\n    );\n  } else {\n    console.log('getUserMedia not supported on your browser!');\n  }\n}\n\nexport function startRecording() {\n    // Start recording\n    mediaRecorder = new MediaRecorder(stream);\n    mediaRecorder.start(10);\n\n    // Start visualizing audio\n    // visualize(stream);\n\n    console.log(\"recorder started\");\n\n    mediaRecorder.ondataavailable = function(e) {\n      chunks.push(e.data);\n    }\n}\n\nexport function stopAudioRecording() {\n  // Stop recording\n  mediaRecorder.stop();\n  console.log(mediaRecorder.state);\n  console.log(\"recorder stopped\");\n  mediaRecorder.onstop = (e) => stopRecording(e);\n}\n\nstopRecording = (e) => {\n  // Stop and save the recording\n  console.log(\"recorder onstopped\");\n\n  const soundClips = document.querySelector('.sound-clips');\n  \n  const clipName = prompt('Enter a name for your sound clip');\n\n  const clipContainer = document.createElement('article');\n  const clipLabel = document.createElement('p');\n  const audio = document.createElement('audio');\n  const deleteButton = document.createElement('button');\n           \n  clipContainer.classList.add('clip');\n  audio.setAttribute('controls', '');\n  deleteButton.innerHTML = \"Delete\";\n  clipLabel.innerHTML = clipName;\n\n  clipContainer.appendChild(audio);\n  clipContainer.appendChild(clipLabel);\n  clipContainer.appendChild(deleteButton);\n  soundClips.appendChild(clipContainer);\n\n  audio.controls = true;\n  const blob = new Blob(chunks, { 'type' : 'audio/ogg; codecs=opus' });\n  \n  chunks = [];\n  const audioURL = window.URL.createObjectURL(blob);\n  audio.src = audioURL;\n\n  deleteButton.onclick = function(e) {\n    let evtTgt = e.target;\n    evtTgt.parentNode.parentNode.removeChild(evtTgt.parentNode);\n  }\n}\n\nvisualize = (stream) => {\n  // Visualize audio stream\n  const canvas = document.querySelector('.visualizer');\n  const canvasCtx = canvas.getContext(\"2d\");\n  let audioCtx;\n\n  if(!audioCtx) {\n    audioCtx = new AudioContext();\n  }\n\n  const source = audioCtx.createMediaStreamSource(stream);\n\n  const analyser = audioCtx.createAnalyser();\n  analyser.fftSize = 2048;\n  const bufferLength = analyser.frequencyBinCount;\n  const dataArray = new Uint8Array(bufferLength);\n\n  source.connect(analyser);\n  //analyser.connect(audioCtx.destination);\n\n  draw()\n\n  function draw() {\n    const WIDTH = canvas.width\n    const HEIGHT = canvas.height;\n\n    requestAnimationFrame(draw);\n\n    analyser.getByteTimeDomainData(dataArray);\n\n    canvasCtx.fillStyle = 'rgb(200, 200, 200)';\n    canvasCtx.fillRect(0, 0, WIDTH, HEIGHT);\n\n    canvasCtx.lineWidth = 2;\n    canvasCtx.strokeStyle = 'rgb(0, 0, 0)';\n\n    canvasCtx.beginPath();\n\n    let sliceWidth = WIDTH * 1.0 / bufferLength;\n    let x = 0;\n\n\n    for(let i = 0; i < bufferLength; i++) {\n\n      let v = dataArray[i] / 128.0;\n      let y = v * HEIGHT/2;\n\n      if(i === 0) {\n        canvasCtx.moveTo(x, y);\n      } else {\n        canvasCtx.lineTo(x, y);\n      }\n\n      x += sliceWidth;\n    }\n\n    canvasCtx.lineTo(canvas.width, canvas.height/2);\n    canvasCtx.stroke();\n\n  }\n}"]},"metadata":{},"sourceType":"module"}