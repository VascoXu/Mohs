(this.webpackJsonpmohs=this.webpackJsonpmohs||[]).push([[0],[,,,,,,,,,function(e,t,n){},,,,,,,,,,function(e,t,n){e.exports=n.p+"static/media/SmashLab.17d6023a.png"},,function(e,t,n){e.exports=n(37)},,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,,,,,function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(17),o=n.n(c),s=(n(26),n(2)),i=n(3),l=n(5),p=n(4),u=n(18),m=n(19),d=n.n(m),h=(n(27),n(8)),g=Object(h.a)(),b=function(e){Object(l.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).handleChange=function(e){var t=e.target.value;(a.setState(Object(u.a)({},e.target.name,t)),"enum"===e.target.name)&&(JSON.parse(localStorage.getItem("enums")||"[]").includes(e.target.value)?a.setState({econsent:!0}):a.state.econsented||a.setState({econsent:!1}))},a.handleExperimenterConsent=function(){a.setState({econsent:!a.state.econsent,econsented:!0})},a.handleParticipantConsent=function(){a.setState({pconsent:!a.state.pconsent})},a.experimenterReady=function(){var e=JSON.parse(localStorage.getItem("enums")||"[]");e.includes(a.state.enum)||(e.push(a.state.enum),localStorage.setItem("enums",JSON.stringify(e))),a.setState({eready:!0})},a.participantReady=function(){g.push("/Home",{pnum:a.state.pnum}),localStorage.setItem("currentPnum",a.state.pnum),fetch("/api/pnum",{method:"POST",body:JSON.stringify({pnum:a.state.pnum}),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){console.log(e)}))},a.state={pnum:"",enum:"",eready:!1,econsent:!1,econsented:!1,pconsent:!1,edit:!1},a}return Object(i.a)(n,[{key:"render",value:function(){var e,t;return e=!(""===this.state.pnum.trim()||""===this.state.enum.trim()||!this.state.econsent||!this.state.pconsent)?r.a.createElement("button",{id:"eready",onClick:this.experimenterReady,className:"btn btn-lg btn-primary btn-block"},"Experimenter Ready"):"",t=this.state.eready?r.a.createElement("button",{id:"pready",onClick:this.participantReady,className:"btn btn-lg btn-info btn-block",type:"submit"},"Participant Ready"):"",r.a.createElement("div",{className:"login text-center"},r.a.createElement("div",{className:"form-signin"},r.a.createElement("img",{className:"mb-4 smash_logo",src:d.a,alt:"Smash Lab"}),r.a.createElement("h1",{className:"h3 mb-3 font-weight-normal"},"Please sign in"),r.a.createElement("div",{className:"input-group mb-2"},r.a.createElement("input",{onChange:this.handleChange,type:"text",name:"enum",id:"inputEnum",className:"form-control",placeholder:"Experimenter number",value:this.state.enum,required:!0,autoFocus:!0}),r.a.createElement("div",{className:"input-group-append"},r.a.createElement("div",{className:"input-group-text"},r.a.createElement("input",{className:"mr-1",onChange:this.handleExperimenterConsent,type:"checkbox",value:"econsent",checked:this.state.econsent})," consent"))),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("input",{onChange:this.handleChange,type:"text",name:"pnum",id:"inputPnum",className:"form-control",placeholder:"Participant Number",value:this.state.pnum,required:!0}),r.a.createElement("div",{className:"input-group-append"},r.a.createElement("div",{className:"input-group-text"},r.a.createElement("input",{className:"mr-1",onChange:this.handleParticipantConsent,type:"checkbox",value:"pconsent",checked:this.state.pconsent})," consent"))),e,t))}}]),n}(a.Component),f=n(11);n(9),n(28);function v(e){window.speechSynthesis.cancel();var t=new SpeechSynthesisUtterance(e);window.speechSynthesis.speak(t)}function E(e){fetch("/api/log",{method:"POST",body:JSON.stringify(e),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){console.log(e)}))}function N(){return(new Date).toLocaleString("en-US",{timeZone:"America/New_York"}).substr(11,8)}var S=function(e){Object(l.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).handleChange=function(e,t){var n=Object(f.a)(a.state.questions);n[e]=t.target.value,a.setState({questions:n})},a.handleClick=function(e,t){var n=a.props.procedure[a.props.step].questions[e][0];v(a.props.procedure[a.props.step].questions[e][1]);var r=N();E({pnum:localStorage.getItem("currentPnum"),timestamp:r,action:"Question ".concat(e,": ").concat(n)})},a.export=function(){fetch("/api/export",{method:"POST",body:JSON.stringify({pnum:localStorage.getItem("currentPnum")}),headers:{"Content-Type":"application/json"}}).then((function(e){return e.blob()})).then((function(e){var t=window.URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download="".concat(localStorage.getItem("currentPnum"),".zip"),document.body.appendChild(n),n.click(),n.remove()}))},a.setEditMode=function(){a.setState({edit:!0})},a.state={step:0,edit:!1},a}return Object(i.a)(n,[{key:"render",value:function(){var e=this,t=[];return this.props.procedure.length>0&&(t=this.props.procedure[this.props.step].questions.slice(0,4)),r.a.createElement("div",{className:"container full-height mt-2"},r.a.createElement("h2",{className:"text-center"},"Questions"),r.a.createElement("hr",null),r.a.createElement("div",{className:"list-group"},t.map((function(t,n){return r.a.createElement("button",{key:n,onClick:e.handleClick.bind(e,n),type:"button",className:"btn btn-light btn-block question"},"Q",n+1,": ",t[0])}))),r.a.createElement("div",{className:"container text-center mt-5"},r.a.createElement("button",{type:"button",onClick:this.recordTime,className:"btn shadow ml-3 btn-dark btn-lg light-border"},r.a.createElement("svg",{width:"1em",height:"1em",viewBox:"0 0 16 16",className:"bi bi-bell-fill",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("path",{d:"M8 16a2 2 0 0 0 2-2H6a2 2 0 0 0 2 2zm.995-14.901a1 1 0 1 0-1.99 0A5.002 5.002 0 0 0 3 6c0 1.098-.5 6-2 7h14c-1.5-1-2-5.902-2-7 0-2.42-1.72-4.44-4.005-4.901z"})),r.a.createElement("span",{className:"ml-2"},"Reminder"))),r.a.createElement("div",{className:"export mr-3 mb-3"},r.a.createElement("button",{onClick:this.export,className:"btn btn-dark"},r.a.createElement("i",{className:"fa fa-download","aria-hidden":"true"}),r.a.createElement("span",{className:"ml-2"},"Finished"))))}}]),n}(a.Component),y=(n(29),function(e){Object(l.a)(n,e);var t=Object(p.a)(n);function n(e){return Object(s.a)(this,n),t.call(this,e)}return Object(i.a)(n,[{key:"render",value:function(){return r.a.createElement("div",{className:"fixed-bottom ml-3 mb-3"},r.a.createElement("div",{className:"container-fluid"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-xs-6"},r.a.createElement("button",{className:"btn btn-light"},r.a.createElement("svg",{className:"bi bi-mic-fill",width:"2em",height:"2em",viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("path",{fill:this.props.recording?"green":"currentColor",d:"M5 3a3 3 0 0 1 6 0v5a3 3 0 0 1-6 0V3z"}),r.a.createElement("path",{fillRule:"evenodd",d:"M3.5 6.5A.5.5 0 0 1 4 7v1a4 4 0 0 0 8 0V7a.5.5 0 0 1 1 0v1a5 5 0 0 1-4.5 4.975V15h3a.5.5 0 0 1 0 1h-7a.5.5 0 0 1 0-1h3v-2.025A5 5 0 0 1 3 8V7a.5.5 0 0 1 .5-.5z"})))),r.a.createElement("div",{className:"col-xs-6 ml-3"},r.a.createElement("canvas",{className:"visualizer"})))))}}]),n}(a.Component)),w=(n(30),{}),k=[];function O(){navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?(console.log("getUserMedia supported."),navigator.mediaDevices.getUserMedia({audio:!0}).then((function(e){return function(e){(w=new MediaRecorder(e)).start(10),console.log("recorder started"),w.ondataavailable=function(e){k.push(e.data)}}(e)})).catch((function(e){console.log("The following getUserMedia error occured: "+e)}))):console.log("getUserMedia not supported on your browser!")}function j(e){w.stop(),console.log(w.state),console.log("recorder stopped"),w.onstop=function(t){return function(e,t){console.log("recorder onstopped");var n=new Blob(k,{type:"audio/wav;"}),a=new FormData;a.append("filename",t),a.append("pnum",localStorage.getItem("currentPnum")),a.append("audio",n),fetch("/api/audio",{method:"POST",body:a}).then((function(e){return e.json()})).then((function(e){console.log(e)})),k=[]}(0,e)}}var C=function(e){Object(l.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).inputChange=function(e,t){var n=Object(f.a)(a.props.procedure);n[e]=t.target.value,a.setState({procedure:n})},a.procedureClick=function(e,t){a.props.updateStep(e),v(a.props.procedure[e].procedure)},a.setEditMode=function(){a.setState({edit:!0})},a.done=function(){var e=a.props.procedure.length;if(a.state.started){v(a.props.procedure[(a.props.step+1)%e].procedure);var t="".concat(localStorage.getItem("currentPnum"),"-").concat(a.props.step),n=N();E({pnum:localStorage.getItem("currentPnum"),timestamp:n,action:"Procedure (Step ".concat(a.props.step,"): ").concat(a.props.procedure[a.props.step].procedure)}),a.props.incrementStep()}else a.setState({started:!0}),v(a.props.procedure[a.props.step%e].procedure);a.state.started&&j(t),a.props.step<e&&O()},a.state={started:!1,edit:!1},a}return Object(i.a)(n,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"full-height mt-2"},r.a.createElement("h2",{className:"text-white text-center"},"Procedure"),r.a.createElement("hr",null),r.a.createElement("div",{className:"container-fluid"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-6"},r.a.createElement("div",{className:"card mt-2"},r.a.createElement("div",{className:"card-body text-center"},this.state.started?r.a.createElement("h5",{className:"card-title"},"Step ",this.props.step,":"):r.a.createElement("h5",{className:"card-title"},"Introduction:"),r.a.createElement("hr",null),this.props.procedure.length>0&&this.state.started?r.a.createElement("p",{id:"step",className:"card-text"}," ",this.props.procedure[this.props.step].procedure," "):r.a.createElement("p",{id:"step",className:"card-text"}," Press DONE to begin procedure and recording."))),r.a.createElement("div",{className:"text-center mt-4"},r.a.createElement("button",{type:"button",onClick:this.repeat,className:"shadow btn btn-secondary btn-lg dark-border"},"Repeat"),r.a.createElement("button",{type:"button",onClick:this.done,className:"shadow btn ml-4 btn-secondary btn-lg dark-border"},"Done"))),r.a.createElement("div",{className:"col-md-6"},r.a.createElement("ul",{className:"list-group list-group-hover mt-2 mb-5 procedure-list"},this.props.procedure.map((function(t,n){return r.a.createElement("li",{key:n,onClick:e.procedureClick.bind(e,n),id:"l"+n,className:"list-group-item ".concat(e.props.step===n&&e.state.started?"active":"")},t.procedure)})))))),r.a.createElement(y,{recording:this.state.started}))}}]),n}(a.Component),x=(n(31),function(e){Object(l.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).getProcedure=function(){fetch("/api/procedure").then((function(e){return e.json()})).then((function(e){console.log(e),a.setState({procedure:e})}))},a.updateStep=function(e){a.setState({step:e})},a.incrementStep=function(){a.setState({step:(a.state.step+1)%a.state.procedure.length})},a.state={procedure:[],step:0},a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.getProcedure()}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"bg-dark split left"},r.a.createElement("div",null,r.a.createElement(C,{incrementStep:this.incrementStep,updateStep:this.updateStep,step:this.state.step,procedure:this.state.procedure,pnum:this.props.pnum}))),r.a.createElement("div",{className:"bg-light split right"},r.a.createElement("div",null,r.a.createElement(S,{incrementStep:this.incrementStep,updateStep:this.updateStep,step:this.state.step,procedure:this.state.procedure,pnum:this.props.pnum}))))}}]),n}(a.Component)),P=n(39),M=function(e){Object(l.a)(n,e);var t=Object(p.a)(n);function n(e){return Object(s.a)(this,n),t.call(this,e)}return Object(i.a)(n,[{key:"render",value:function(){return r.a.createElement(P.b,{history:g},r.a.createElement(P.c,null,r.a.createElement(P.a,{path:"/",exact:!0,component:b}),r.a.createElement(P.a,{path:"/Home",component:x})))}}]),n}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(M,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[21,1,2]]]);
//# sourceMappingURL=main.3999c355.chunk.js.map